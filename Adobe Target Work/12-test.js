<style>
    .LOR56B caas-header {
        border-bottom: solid 2px rgba(195, 195, 195, 0.5);
    }
    .LOR56B #mainArticle {
        width: 100%;
        max-width: 980px;
        margin: 0 auto;
        background: none;
        padding: 20px 0 0;
    }
    .LOR56B #mainArticle #articleTitle {
        z-index: 1;
        position: relative;
        width: 100%;
        max-width: 680px;
    }
    .LOR56B #mainArticle #articleTitle #innerWrapper {
        -webkit-box-shadow: 0px 8px 16px -7px rgba(195,195,195,1);
        -moz-box-shadow: 0px 8px 16px -7px rgba(195,195,195,1);
        box-shadow: 0px 8px 16px -7px rgba(195,195,195,1);
        margin: -30px 15px 25px;
        padding: 0 15px;
        background-color: #ffffff;
    }
    .LOR56B #mainArticle #articleTitle h2#articleTitleText {
        color: #232323;
        font-family: "Roboto Condensed Bold", "Arial", "Helvetica", "sans-serif";
        font-size: 2.5em;
        margin: 0;
    }
    .LOR56B #mainArticle #articleDescription {
        font-family: Georgia, serif;
        font-size: 1.3em;
        color: #232323;
        line-height: 1.3em;
        margin: 0 15px;
        padding: 0 15px;
        max-width: 620px;
    }
    .LOR56B #mainArticle #articleImage {
        width: 100%;
        max-width: 680px;
        height: auto;
    }
    .LOR56B #masterOffer {
        background-color: #2C3139;
        color: #fff;
        -webkit-box-shadow: 0px 0px 10px 12px rgba(195,195,195,0.5);
        -moz-box-shadow: 0px 0px 10px 12px rgba(195,195,195,0.5);
        box-shadow: 0px 0px 10px 12px rgba(195,195,195,0.5);
        margin-top: 30px;
    }
    .LOR56B #masterOffer .hero-offer-content .hero-breach-message-container {
        padding: 25px;
        text-align: center;
        text-transform: uppercase;
        font-family: "Roboto Condensed Bold", "Arial", "Helvetica", "sans-serif";
    }
    .LOR56B #masterOffer .hero-offer-content .hero-breach-message-container h2 {
        font-size: 34px;
        margin: 0;
    }
    .LOR56B #masterOffer .hero-offer-content .hero-breach-message-container h2 span {
        font-size: 18px;
        padding-top: 8px;
        font-family: "Roboto", "Helvetica", "Arial", "Helvetica", "sans-serif";
        display: block;
    }
    .LOR56B #masterOffer .hero-offer-content .hero-offer-details-container {
        max-width: 980px;
        margin: 0 auto;
    }
    .LOR56B #masterOffer .hero-offer-content .hero-offer-details-container .hero-offer-features-item-details ul li {
        display: inline-block;
        max-width: 200px;
        margin-left: 40px;
        vertical-align: top;
        position: relative;
        font-family: "Roboto", "Helvetica", "Arial", "Helvetica", "sans-serif";
    }
    .LOR56B #masterOffer .hero-offer-content .hero-offer-details-container .hero-offer-features-item-details ul li:before {
        content: "\2713";
        position: absolute;
        left: -17px;;
        top: 0;
    }
    .LOR56B #masterOffer .hero-offer-content .hero-offer-details-container .hero-offer-features-item-details ul li p {
        margin: 0;
    }
    .LOR56B #masterOffer .hero-offer-content .hero-offer-features-content {
        border-top: solid 2px #41454C;
        border-bottom: solid 2px #41454C;
        margin-bottom: 20px;
        font-size: 15px;
    }
    .LOR56B #masterOffer .hero-offer-content .hero-offer-features-content .hero-offer-features-item-details {
        margin: 0 auto;
    }
    .LOR56B #masterOffer .hero-offer-content .hero-offer-details-container .hero-button-container {
        text-align: center;
        padding: 0 0 30px 0;
    }
    .LOR56B #masterOffer .hero-offer-content .hero-offer-details-container .hero-button-container::after {
        width: 30px;
        height: 24px;
        content: " ";
        background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADgAAAAiCAMAAAA9FerRAAAABGdBTUEAALGPC/xhBQAAACBjSFJN AAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAB1FBMVEUAAACAgL9mcIFmboBt kpJmcoFlb4BrcoZmcIFlb4GAgJ9nboFmboBlboBqcYdmboFmboBlcYNmb4Fmb4FmdYNmboFlb4Fx cY5mcYNlboBmb4FpcYdlb4Bmb4FncYNmboFlb4Bmb4Flb4BmgJlnboNmcIGAgKplb4BmboFob4Nl cIFmboFlb4B0dItncYFob4FlboFmboFncYFmboFnb4FmmZlmb4BlboFqgJVoboFlb4Fmb4Blb4Fm b4BocINmb4Flb4F2dolmb4Flb4FocINlboBmboBnb4Fnb4RlboBmb4FtgJJncIFlboFmboBpcYJm b4FlboBocIFlb4FocIKqqqpmb4Bmb4Fmd4hlcIFmb4BmboBncIJmb4Bmb4FwcI9mboFpcoRlboFm b4BnboFmb4FocYSAgP9mboFlboFpeIdmcIJlboFlb4Blb4Jlb4Bmb4BnboJmboFpboJmcIFmboFx cY5nboJlb4BocoJmb4Flb4BreYZlb4JmboFqcIX///9mboBmboFmb4Jmb4BncoJmboBlboBlboFm cYJlb4Fmb4BoboVmb4Flb4Fnc4Zlb4BmboBqcINnb4Bmb4Fmc4Zmb4BlboFnboNncIFlboD////Y BnDKAAAAmnRSTlMABIK3B0HbJoC4CEP15SR/uUT25CN9uglG9+IitbxI+Pm0vQpKSwazvkxJsr8L TUewwE/6RQWvwgxRrsNT+0KsxA1V9ECrxVc+qcYOWfzzPajHW/I7A6fID1398TmlyhBfOKTLYfA2 AqLMEWT+7zWhzWbuM6DOEmjtMZ7PE2rsMAGd0GzrL5vj6i2a6SyY6CqX5ymV5iiTkiWQpTNBUwAA AAFiS0dEgGW9nmgAAAAHdElNRQfjBhgGDgtLNcHoAAABqklEQVQ4y6XV51MTURQF8LsUQQJRIj0Q UCBKl14EAQtdkBKU3pTQexEIRXovggj71/qSPWEWsrvZDedL3jv3/nYmyUxC9JhwHq57eftocb5P /ISDP88/DVDvdIF8kN5+eMazPFctgw1s/UUIUSjvSFi4OhcR6ViPMlK0APkYVdIUK2zHmcjnJeSr ePcuAS42kV3MryHfuJVJcXDJjqs5BTI1Tdmlw0VmoDC/hcxUlFnZwpYh567KzYPML5B3hU6nE5W5 RZDvZGVxibAR+P5ezZVClpVLuw9wHz89GHCfISskZaXTVbmMuGrImlpXV/dFmNU3SDyU+wrZ6CKb 4JpbJN+GpRXy2/f7g7Z2oe/olPngLF2Q3T3iutfp+mS/Kks/5IBI/oD7OUjysQ5BDo84q9ExoRmf IKVYJyGnIKfhZmZJOdY5yPkF+3UR7tcSuYt1GXLFRrQKt7bu1hFt/IbctG3htL2jwjG5i/09vO4f qHJMHvLiHB2rdEyeiNzpmWrH5Pmdu/ijwTF5CXf1V5NjuXa4ID+tjuif/af+RrsjuuX39J449rdi VBj+B6U0ArvqmBSnAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDE5LTA2LTI0VDA2OjE0OjExKzAzOjAw WSvO/wAAACV0RVh0ZGF0ZTptb2RpZnkAMjAxOS0wNi0yNFQwNjoxNDoxMSswMzowMCh2dkMAAAAA SUVORK5CYII=");
        display: block;
        background-repeat: no-repeat;
        background-size: 30px;
        text-align: center;
        margin: 20px auto 0;
        justify-content: center;
    }
    .LOR56B #masterOffer .hero-offer-content .hero-offer-details-container .hero-button-container button {
        min-width: 160px;
        background: transparent;
        font-family: "Roboto", "Helvetica", "Arial", "Helvetica", "sans-serif";
        font-size: 16px;
        font-weight: normal;
        color: #ffffff;
        cursor: pointer;
        border-radius: 40px;
        margin: 0;
        padding: 10px;
    }
    .LOR56B #masterOffer .hero-offer-content .hero-offer-details-container .hero-button-container button:first-child {
        margin-right: 10px;
    }
    .LOR56B #masterOffer .hero-offer-content .hero-offer-details-container .hero-button-container button:last-child {
        margin-left: 10px;
    }
    .LOR56B #masterOffer .hero-offer-content .hero-offer-details-container .hero-button-container button.subscribe {
        border: none;
        background-color: #E33995;   
    }
    .LOR56B #fullDigital,
    .LOR56B #fullDigital h3,
    .LOR56B #masterOffer .hero-offer-content .hero-offer-details-container .hero-offer-features-item-details ul {
        display: inline-block;
    }
    .LOR56B #fullDigital h3 {
        font-family: "Roboto Condensed Bold", "Arial", "Helvetica", "sans-serif";
        font-weight: 400;
        text-transform: uppercase;
        color: #18ADF0;
        margin: 0;
    }
    .LOR56B #fullDigital img.hero-offer-device-image {
        width: 40px;
        margin-right: 15px;
        margin-top: 0;
        vertical-align: middle;
    }
    .LOR56B #loginButton {
        display: inline-block;
        margin-left: 10px;
    }
    .LOR56B #loginButton .caas-login-button-0 .login {
        border: solid 2px #fff;
        text-decoration: none;
        font-size: 1em;
        background: transparent;
    }
    .LOR56B .hero-offer-content .hero-offer-features-item.hero-offer-features-item-details .premium {
        position: relative;
        margin-left: 15px;
    }
    .LOR56B .hero-offer-content .hero-offer-features-item.hero-offer-features-item-details .premium:before {
        content: " ";
        position: absolute;
        top: 0;
        left: -15px;
        width: 14px;
        height: 14px;
        background: transparent url(https://subscriptions.news.com.au/latest/a/common/images/icon-premium.png) no-repeat top right;
        background-size: contain;
    }
    /***************************/
    @media (min-width:768px) and (max-width: 980px) {
        .LOR56B #mainArticle {
            padding: 0 15px;
        }
        .LOR56B #masterOffer .hero-offer-content .hero-offer-details-container {
            padding: 0 15px;
        }
    }
    @media (max-width: 767px) {
        .LOR56B caas-header {
            border-bottom: none;
        }
        .LOR56B #mainArticle {
            padding: 0;
        }
        .LOR56B #mainArticle #articleTitle h2#articleTitleText {
            font-size: 25px;
        }
        .LOR56B #mainArticle #articleTitle h2#articleTitleText,
        .LOR56B #mainArticle #articleDescription,
        .LOR56B #mainArticle #articleImage {
            max-width: none;
        }
        .LOR56B caas-offers {
            display: none;
        }
        .LOR56B #masterOffer .hero-offer-content .hero-offer-details-container .hero-button-container {
            padding: 0 0 10px 0;
        }
        .LOR56B #masterOffer .hero-offer-content .hero-offer-details-container .hero-offer-features-item-details ul,
        .LOR56B #masterOffer #fullDigital {
            width: 50%;
            display: table-cell;
        }
        .LOR56B #masterOffer #fullDigital {
            text-align: center;
        }
        .LOR56B #masterOffer #fullDigital h3 {
            font-size: 20px;
        }
        .LOR56B #masterOffer .hero-offer-content .hero-offer-details-container .hero-offer-features-item-details ul {
            padding-left: 0;
        }
        .LOR56B #masterOffer .hero-offer-content .hero-offer-features-content {
            border: none;
            padding: 0 15px;
            font-size: 12px;
        }
        .LOR56B #masterOffer .hero-offer-content .hero-offer-details-container .hero-offer-features-item-details ul li {
            margin-left: 20px;
        }
        .LOR56B #fullDigital img.hero-offer-device-image {
            width: 80px;
            margin: 0 0 10px 0;
            vertical-align: top;
        }
    }
</style>
<script>	
    (function(window, document) {
        let searchParams = new URLSearchParams(window.location.search);
        const TCOGURL = 'https://a.tcog.news.com.au/component/article/story-preview-';
        const TCOGPARAM = '?esi=true&t_product=consumer-commerce&t_output=json';

        function newV21() {
            const path = window.location.search;
            if (!searchParams.get('v21suffix')) {
                searchParams.set('v21suffix', '56-b');
                window.location.replace(window.location.origin + window.location.pathname + '?' + searchParams.toString());
            }
        };

        newV21();

        /**
        * adds body class
        **/
        function addBodyClass() {
            document.body.classList.add('LOR56B');
        }

        /**
        * @param needle
        * @param haystack
        * @param callback
        **/
        function waitForElement(needle, haystack, callback) {
            let targetNode = document.querySelectorAll(haystack)[0];
            let config = {childList: true, subtree: true};

            let observerCallback = function(mutationsList, observer) {
                for(let mutation of mutationsList) {
                    if (document.querySelectorAll(needle).length > 0) {
                        observer.disconnect();
                        callback();
                        break;
                    }
                }
            };

            let observer = new MutationObserver(observerCallback);
            observer.observe(targetNode, config);
        }

        /**
        * @return articleId (string)
        **/
        function getArticleId() {
            const dest = searchParams.get('dest');
            
            if (dest) {
                const articleUrl = new URL(dest);
                const articleId = articleUrl.pathname.split('/').pop();

                return articleId;
            }
            
            return;
        }

        /**
        * @parameter articleId (string)
        * @return requestUrl (string)
        **/
        function buildTcogUrl(articleId) {
            let requestUrl = null;
            
            if (articleId) {
                requestUrl = encodeURI(TCOGURL + articleId + TCOGPARAM);
            }

            return requestUrl;
        }

        /**
        * function to create element without document
        * @parameter element (string)
        * @return Node
        **/
        function createNode(element) {
            return document.createElement(element);
        }

        /**
        * @parameter (string)
        * @return 
        **/
        function strip(html) {
            let tmp = document.createElement("DIV");
            tmp.innerHTML = html;

            return tmp.textContent || tmp.innerText || "";
        }

        /**
        * Sets exiting content to display none
        **/
        function hideOldContent() {
            document.querySelector('caas-hero-offer').style.display = 'none';
        }

        /**
        * Change the main article data
        * @param data
        **/
        function changeArticleData(data) {
            const articleTitleText = data.subtitle;
            const articleDescription = strip(data.subscriptionSummary);
            let header = document.querySelector('caas-header');

            if (header && !document.getElementById('mainArticle') && articleTitleText && articleDescription) {
                let mainArticle = createNode('DIV');
                mainArticle.id = 'mainArticle';

                header.after(mainArticle);

                let articleContent = document.getElementById('mainArticle');

                if (typeof articleContent != 'undefined') {
                    const articleHTML = `<div id='articleImageHolder'></div>
                        <div id='articleTitle'>
                            <div id='innerWrapper'>
                                <h2 id='articleTitleText'></h2>
                            </div>
                        </div>
                        <p id='articleDescription'></p>`;

                    articleContent.innerHTML = articleHTML;
                }

                if (document.getElementById('articleImageHolder')) {
                    let articleImage = createNode('IMG');
                    articleImage.id = 'articleImage';

                    document.getElementById('articleImageHolder').append(articleImage);
                    document.getElementById('articleTitleText').textContent = articleTitleText;
                    document.getElementById('articleDescription').textContent = articleDescription;

                    let image = document.getElementById('articleImage');

                    if (data.related.length >= 3 && data.related[2].link && typeof image !== 'undefined') {
                        image.src = data.related[2].link;
                    }

                    changeMasterOffer(); // as article correctly added we can change the offer
                }
            }
        }

        /**
        * change the master offer
        **/
        function changeMasterOffer() {
            const masthead = window.location.hostname;
            let container = document.querySelector('#mainArticle');
            let offerContainer = document.getElementById('masterOffer');

            if (!offerContainer && masthead) {
              console.log(window);
              console.log(window.location.hostname);
              console.log('Hello, this is the location: ' + window.location.hostname);
                let html = `<div class="hero-offer-content">
                        <div class="hero-breach-message-container">
                            <h2 class="caas-breach-message-base">There's more to this story <span>But it\`s a member-only story. Subscribe today to unlock it and more...</span></h2>
                        </div>
                        <div class="hero-offer-details-container">
                            <div class="hero-offer-details">
                                <div class="hero-offer-features-content">
                                    <div class="hero-offer-features-item hero-offer-features-item-details">
                                        <div id="fullDigital">
                                            <img class="hero-offer-device-image" src="https://myaccount.news.com.au/bizopsimages/offersets/images/heraldsun/pack-digital.png">
                                            <h3>Full Digital Access</h3>
                                        </div>
                                        <ul>
                                            <li><p>Unlimited access to ${window.location.hostname} on desktop, tablet and mobile</p></li>
                                            <li><p>Full access across our News+ Network, SuperCoach Stats and more</p></li>
                                            <li><p>Exclusive <span class="premium">Rewards</span>^</p></li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                            <div class="hero-button-container">
                                <button class="subscribe button">Subscribe Now</button>
                                <button class="login style-scope caas-login-button-base">
                                    <span class="style-scope caas-login-button-base">Login</span>
                                </button>
                            </div>
                        </div>
                    </div>`;
                
                let masterOffer = createNode('DIV');
                masterOffer.id = 'masterOffer';
                masterOffer.innerHTML = html;
                container.after(masterOffer);
            }
        }

        /**
        * @parameter articleId (string)
        * @return response (json)
        **/
        function requestArticle(articleId) {
            let requestUrl = buildTcogUrl(articleId);

            if (requestUrl) {
                fetch(requestUrl)
                .then(function(response) {
                    // wait for tcog response before we make changes
                    return response.json();
                })
                .then((article) => {
                    waitForElement('caas-subscription-form-template', 'caas-offers', () => {
                        addBodyClass();
                        changeArticleData(article.data);
                        hideOldContent();
                    });
                })
                .catch((error) => {
                    console.log(error);
                });
            }
        }

        /**
        * init function
        **/
        function init() {
            let articleId = getArticleId();
            
            if (articleId) {
                requestArticle(articleId);
            }
        }

        waitForElement('caas-subscription-form-template', 'caas-subscription-form', () => {
            waitForElement('caas-header', 'caas-subscription-form-template', () => {
                init();
            });
        });
    })(window, document);
</script>